!function(a){"use strict";function f(c,d,f){var l,m,p,g=this;return d=d||{},p=a.extend(!0,{async:!0,overwriteCache:!1,complete:null,success:null,error:function(){a(this).each(function(){a(this).html(p.errorMessage)})},errorMessage:"There was an error loading the template.",paged:!1,pageNo:1,elemPerPage:10,noDivWrapper:!1,append:!1,prepend:!1,beforeInsert:null,afterInsert:null,bindingOptions:{ignoreUndefined:!1,ignoreNull:!1,ignoreEmptyString:!1}},f),"array"===a.type(d)?(e=!0,i.call(this,c,d,p)):(h(c)||(l=a(c),"string"==typeof c&&0===c.indexOf("#")&&(p.isFile=!1)),m=p.isFile||"undefined"==typeof p.isFile&&("undefined"==typeof l||0===l.length),m&&!p.overwriteCache&&b[c]?k(c,g,d,p):m&&!p.overwriteCache&&b.hasOwnProperty(c)?j(c,g,d,p):m?n(c,g,d,p):o(l,g,d,p),this)}function g(b,c){c?d[b]=c:d=a.extend(d,b)}function h(a){return"string"==typeof a&&a.indexOf("/")>-1}function i(b,c,d){var m,e,g,h,i,j,k,l,n;return d=d||{},e=this,g=c.length,h=d.prepend&&!d.append,i=0,j=0,k=!1,l=[],d.paged&&(n=(d.pageNo-1)*d.elemPerPage,c=c.slice(n,n+d.elemPerPage),g=c.length),m=a.extend({},d,{async:!1,complete:function(b){if(this.html){var c;c=h?a(this).prependTo(e):a(this).appendTo(e),d.afterInsert&&b&&d.afterInsert(c,b)}i++,(i===g||k)&&(k&&d&&"function"==typeof d.error&&d.error.call(e,l),d&&"function"==typeof d.complete&&d.complete())},success:function(){j++,j===g&&d&&"function"==typeof d.success&&d.success()},error:function(a){k=!0,l.push(a)}}),d.append||d.prepend||e.html(""),d.noDivWrapper&&(m.append=!0),h&&c.reverse(),a(c).each(function(){var c=a("<div/>");return f.call(d.noDivWrapper?e:c,b,this,m),k?!1:void 0}),this}function j(a,b,d,e){c[a]?c[a].push({data:d,selection:b,settings:e}):c[a]=[{data:d,selection:b,settings:e}]}function k(a,c,d,e){var f=b[a].clone();p.call(c,f,d,e),"function"==typeof e.success&&e.success()}function l(){return(new Date).getTime()}function m(a){return-1!==a.indexOf("?")?a+"&_="+l():a+"?_="+l()}function n(c,d,e,f){var h,g=a("<div/>");b[c]=null,h=c,f.overwriteCache&&(h=m(h)),a.ajax({url:h,async:f.async,success:function(b){g=f.noDivWrapper?a(b):g.html(b),r(g,c,d,e,f)},error:function(a){q(c,d,e,f,a)}})}function o(b,c,d,e){var f=a("<div/>");(b.is("script")||b.is("template"))&&(b=a(a.parseHTML(a.trim(b.html())))),f=e.noDivWrapper?b:f.html(b),p.call(c,f,d,e),"function"==typeof e.success&&e.success()}function p(b,c,d){s(d.noDivWrapper?a("<div></div>").append(b):b,c,d),a(this).each(function(){var f=b.clone(!0);a("select",f).each(function(c){a(this).val(a("select",b).eq(c).val())}),d.beforeInsert&&d.beforeInsert(f,c),d.append?a(this).append(f):d.prepend?a(this).prepend(f):a(this).html("").append(f),d.afterInsert&&!e&&d.afterInsert(f,c)}),"function"==typeof d.complete&&d.complete.call(a(this),c)}function q(b,d,e,f,g){var h;for("function"==typeof f.error&&f.error.call(d,g),a(c[b]).each(function(a,b){"function"==typeof b.settings.error&&b.settings.error.call(b.selection,g)}),"function"==typeof f.complete&&f.complete.call(d);c[b]&&(h=c[b].shift());)"function"==typeof h.settings.complete&&h.settings.complete.call(h.selection);"undefined"!=typeof c[b]&&c[b].length>0&&(c[b]=[])}function r(a,d,e,f,g){var h;for(b[d]=a.clone(),p.call(e,a,f,g),"function"==typeof g.success&&g.success.call(e);c[d]&&(h=c[d].shift());)p.call(h.selection,b[d].clone(),h.data,h.settings),"function"==typeof h.settings.success&&h.settings.success.call(h.selection)}function s(b,c,d){c=c||{},t("data-content",b,c,d,function(a,b){a.html(z(a,b,"content",d))}),t("data-content-append",b,c,d,function(a,b){a.append(z(a,b,"content",d))}),t("data-content-prepend",b,c,d,function(a,b){a.prepend(z(a,b,"content",d))}),t("data-content-text",b,c,d,function(a,b){a.text(z(a,b,"content",d))}),t("data-innerHTML",b,c,d,function(a,b){a.html(z(a,b,"content",d))}),t("data-src",b,c,d,function(a,b){a.attr("src",z(a,b,"src",d))},function(a){a.remove()}),t("data-href",b,c,d,function(a,b){a.attr("href",z(a,b,"href",d))},function(a){a.remove()}),t("data-alt",b,c,d,function(a,b){a.attr("alt",z(a,b,"alt",d))}),t("data-id",b,c,d,function(a,b){a.attr("id",z(a,b,"id",d))}),t("data-class",b,c,d,function(a,b){a.addClass(z(a,b,"class",d))}),t("data-link",b,c,d,function(b,c){var e=a("<a/>");e.attr("href",z(b,c,"link",d)),e.html(b.html()),b.html(e)}),t("data-link-wrap",b,c,d,function(b,c){var e=a("<a/>");e.attr("href",z(b,c,"link-wrap",d)),b.wrap(e)}),t("data-options",b,c,d,function(b,c){a(c).each(function(){var c=a("<option/>");c.attr("value",this).text(this).appendTo(b)})}),w(b,c,d),t("data-value",b,c,d,function(a,b){a.val(z(a,b,"value",d))})}function t(b,c,d,e,f,g){a("["+b+"]",c).each(function(){var c=a(this),h=c.attr(b),i=y(d,h);return u(c,i,e)?(c.removeAttr(b),"undefined"!=typeof i&&f?f(c,i):g&&g(c),void 0):(c.remove(),void 0)})}function u(a,b,c){var d=v(a,c);return d.ignoreUndefined&&"undefined"==typeof b?!1:d.ignoreNull&&null===b?!1:d.ignoreEmptyString&&""===b?!1:!0}function v(b,c){var d={};return b instanceof jQuery&&b.attr("data-binding-options")?(d=a.parseJSON(b.attr("data-binding-options")),b.removeAttr("data-binding-options")):"object"==typeof b&&b.hasOwnProperty("bindingOptions")&&(d=b.bindingOptions),a.extend({},c.bindingOptions,d)}function w(b,c,d){a("[data-template-bind]",b).each(function(){var b=a(this),e=a.parseJSON(b.attr("data-template-bind"));b.removeAttr("data-template-bind"),a(e).each(function(){var e,f;if(e="object"==typeof this.value?y(c,this.value.data):y(c,this.value),this.attribute){if(!u(this,e,d))return b.remove(),void 0;switch(this.attribute){case"content":case"innerHTML":b.html(x(b,e,this));break;case"contentAppend":b.append(x(b,e,this));break;case"contentPrepend":b.prepend(x(b,e,this));break;case"contentText":b.text(x(b,e,this));break;case"options":f=this,a(e).each(function(){var c=a("<option/>");c.attr("value",this[f.value.value]).text(x(b,this[f.value.content],f)).attr("selected",void 0==typeof this[f.value.selected]?!1:this[f.value.selected]).appendTo(b)});break;default:b.attr(this.attribute,x(b,e,this))}}})})}function x(a,b,c,e){return c.formatter&&d[c.formatter]?function(e){return d[c.formatter].call(a,b,c.formatOptions,e)}(e):b}function y(a,b){if("this"===b)return a;for(var d,c=b.split("."),e=a;(d=c.shift())&&"undefined"!=typeof e&&null!=e;)e=e[d];return e}function z(b,c,e,f){var h,i,g=b.attr("data-format-target");return(g===e||!g&&"content"===e)&&(h=b.attr("data-format"),h&&"function"==typeof d[h])?(i=b.attr("data-format-options"),function(e){return d[h].call(b[0],c,i,a.extend({},e))}(f)):c}var e,b={},c={},d={};g("nestedTemplateFormatter",function(b,c,d){var e,f;if(c)return"string"==typeof c&&"{"===c[0]&&(c=a.parseJSON(c)),e=c.parentElement||"div",f=c.template||c,c.parentElement?a("<"+e+"/>").loadTemplate(f,b,d):a("<"+e+"/>").loadTemplate(f,b,d).children()}),a.fn.loadTemplate=f,a.addTemplateFormatter=g}(jQuery);